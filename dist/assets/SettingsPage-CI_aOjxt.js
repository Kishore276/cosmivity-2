import{c as E,e as k,u as D,d as L,r as o,j as s,E as U,x as z,y as F}from"./index-CWgw_Ts5.js";import{D as I,S as A}from"./DashboardLayout-BhgelqLG.js";import{C as T}from"./card-BFUmA-gF.js";import{B as i}from"./button-CcjTP62G.js";import{I as x}from"./input-rGQp_Yl5.js";import{L as c}from"./label-C7e2Xntc.js";import{S as q}from"./square-pen-DcJS-h6i.js";import{E as f}from"./eye-off-Bf5SBX0-.js";import{E as g}from"./eye-DpjMcnRG.js";import"./index-DUESD09M.js";import"./logo-CmdS9hhj.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],M=E("Shield",B);function Z(){const{user:Y,firebaseUser:a,loading:l}=k(),j=D(),{toast:n}=L(),[u,v]=o.useState(!1),[N,m]=o.useState(!1),[w,P]=o.useState(!1),[h,y]=o.useState(!1),[p,b]=o.useState(!1);o.useEffect(()=>{!l&&!a&&j("/auth")},[a,l,j]);const[r,d]=o.useState({currentPassword:"",newPassword:"",confirmPassword:""}),C=async()=>{if(!a){n({variant:"destructive",title:"Error",description:"You must be logged in to change your password."});return}if(r.newPassword!==r.confirmPassword){n({variant:"destructive",title:"Error",description:"New passwords do not match."});return}if(r.newPassword.length<6){n({variant:"destructive",title:"Error",description:"New password must be at least 6 characters long."});return}if(!r.currentPassword){n({variant:"destructive",title:"Error",description:"Please enter your current password."});return}v(!0);try{const t=U.credential(a.email,r.currentPassword);await z(a,t),await F(a,r.newPassword),d({currentPassword:"",newPassword:"",confirmPassword:""}),m(!1),n({title:"Password updated",description:"Your password has been changed successfully."})}catch(t){let e="Failed to update password. Please try again.";switch(t.code){case"auth/wrong-password":case"auth/invalid-credential":e="Current password is incorrect.";break;case"auth/weak-password":e="New password is too weak. Please choose a stronger password.";break;case"auth/requires-recent-login":e="Please log out and log back in before changing your password.";break}n({variant:"destructive",title:"Error",description:e})}finally{v(!1)}},S=()=>{d({currentPassword:"",newPassword:"",confirmPassword:""}),m(!1)};return l?s.jsx("div",{className:"min-h-screen bg-background text-foreground flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})}):a?s.jsx(I,{children:s.jsxs("div",{className:"p-4 sm:p-6 space-y-6 max-w-2xl mx-auto",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-foreground flex items-center gap-3",children:[s.jsx(A,{className:"h-8 w-8"}),"Settings"]}),s.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage your account settings."})]}),s.jsxs(T,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx(M,{className:"h-5 w-5"}),s.jsx("h2",{className:"text-xl font-semibold",children:"Account Security"})]}),s.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Update your password to keep your account secure."}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{children:[s.jsx(c,{className:"text-base font-medium",children:"Password"}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Account created on ",a?.metadata?.creationTime?new Date(a.metadata.creationTime).toLocaleDateString():"Unknown date"]})]}),s.jsxs(i,{variant:"outline",onClick:()=>m(!0),disabled:N,className:"flex items-center gap-2",children:[s.jsx(q,{className:"h-4 w-4"}),"Change"]})]}),N&&s.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(c,{htmlFor:"currentPassword",children:"Current Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(x,{id:"currentPassword",type:w?"text":"password",value:r.currentPassword,onChange:t=>d(e=>({...e,currentPassword:t.target.value})),placeholder:"Enter your current password",className:"pr-10"}),s.jsx(i,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>P(!w),children:w?s.jsx(f,{className:"h-4 w-4"}):s.jsx(g,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(c,{htmlFor:"newPassword",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(x,{id:"newPassword",type:h?"text":"password",value:r.newPassword,onChange:t=>d(e=>({...e,newPassword:t.target.value})),placeholder:"Enter your new password",className:"pr-10"}),s.jsx(i,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>y(!h),children:h?s.jsx(f,{className:"h-4 w-4"}):s.jsx(g,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(c,{htmlFor:"confirmPassword",children:"Confirm New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(x,{id:"confirmPassword",type:p?"text":"password",value:r.confirmPassword,onChange:t=>d(e=>({...e,confirmPassword:t.target.value})),placeholder:"Confirm your new password",className:"pr-10"}),s.jsx(i,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>b(!p),children:p?s.jsx(f,{className:"h-4 w-4"}):s.jsx(g,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[s.jsx(i,{onClick:C,disabled:u,className:"flex items-center gap-2",children:u?"Updating...":"Save Password"}),s.jsx(i,{variant:"outline",onClick:S,disabled:u,children:"Cancel"})]})]})]})]})]})}):null}export{Z as default};
