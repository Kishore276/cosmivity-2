import{e as j,u as N,r as i,j as e,a3 as R,o as C}from"./index-CWgw_Ts5.js";import{C as k}from"./card-BFUmA-gF.js";import{B as m}from"./button-CcjTP62G.js";import{I as T}from"./input-rGQp_Yl5.js";import{u as w}from"./use-toast-DBaDvaQK.js";function A(){const{user:v,firebaseUser:l}=j(),{toast:r}=w(),x=N(),[t,c]=i.useState("public"),[s,h]=i.useState(""),[u,n]=i.useState(!1),[d,y]=i.useState(null),b=async()=>{if(!l||!s.trim()){r({variant:"destructive",title:"Error",description:"Please enter a room name and login."});return}n(!0);let a=!1;const p=setTimeout(()=>{a=!0,n(!1),r({variant:"destructive",title:"Network Timeout",description:"Room creation is taking too long. Please check your connection or try again later."})},8e3);try{let o;t==="private"&&(o=await R(),y(o));const f={name:s,description:`A ${t} study room`,type:t,topic:"General Study",hostId:l.uid,hostName:v.name||"Anonymous",maxParticipants:10,isActive:!0};o&&(f.roomKey=o);const g=await C.createRoom(f);if(clearTimeout(p),a)return;r({title:"Room Created!",description:t==="private"?`Room Key: ${o}`:"Your room is now visible to everyone."}),x(`/rooms/${g}`)}catch{if(clearTimeout(p),a)return;r({variant:"destructive",title:"Error",description:"Failed to create room."})}finally{n(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs(k,{className:"p-8 w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Create a Room"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-2 font-medium",children:"Room Type"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(m,{variant:t==="public"?"default":"outline",onClick:()=>c("public"),children:"Public"}),e.jsx(m,{variant:t==="private"?"default":"outline",onClick:()=>c("private"),children:"Private"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block mb-2 font-medium",children:"Room Name"}),e.jsx(T,{value:s,onChange:a=>h(a.target.value),placeholder:"Enter room name"})]}),e.jsx(m,{className:"w-full",onClick:b,disabled:u||!s.trim(),children:u?"Creating...":"Create Room"}),d&&e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("span",{className:"font-mono bg-muted px-2 py-1 rounded",children:["Room Key: ",d]})})]})})}export{A as default};
